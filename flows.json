[{"id":"63b8a57d.e20efc","type":"tab","label":"Weather","disabled":false,"info":""},{"id":"3f33cde5.12a962","type":"tab","label":"Moon","disabled":false,"info":""},{"id":"9c37bb05.ca8348","type":"tab","label":"Uhr","disabled":false,"info":""},{"id":"f3d8d3e7.d5de6","type":"ui_group","z":"","name":"Masterswitches","tab":"","order":6,"disp":false,"width":"6","collapse":false},{"id":"32b1bef.d468e42","type":"ui_group","z":"","name":"Condition","tab":"","order":5,"disp":false,"width":"4","collapse":false},{"id":"b9059e94.33582","type":"ui_group","z":"","name":"Wind","tab":"","order":4,"disp":false,"width":"4","collapse":false},{"id":"8288de71.c9838","type":"ui_group","z":"","name":"Luftfeuchtigkeit","tab":"","order":4,"disp":false,"width":"6","collapse":false},{"id":"a00e6f37.6655f","type":"ui_group","z":"","name":"Condition","tab":"","order":2,"disp":false,"width":"2","collapse":false},{"id":"673e928c.0926ac","type":"ui_group","z":"","name":"Forecast","tab":"","order":6,"disp":false,"width":"8","collapse":false},{"id":"9127e088.66c24","type":"ui_base","theme":{"name":"theme-custom","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"MasterProfile","default":"#4B7930","baseColor":"#0a6803","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#4B7930","value":"#0a6803","edited":true},"page-titlebar-backgroundColor":{"value":"#0a6803","edited":false},"page-backgroundColor":{"value":"#000000","edited":true},"page-sidebar-backgroundColor":{"value":"#000000","edited":true},"group-textColor":{"value":"#11b205","edited":false},"group-borderColor":{"value":"#000000","edited":true},"group-backgroundColor":{"value":"#000000","edited":true},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#0a6803","edited":false},"widget-borderColor":{"value":"#000000","edited":true},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"true","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"38fa5df2.9cb222","type":"ui_tab","z":"","name":"MAIN","icon":"dashboard","order":4,"disabled":false,"hidden":false},{"id":"79430bf5.e7dee4","type":"ui_group","z":"","name":"Weather","tab":"38fa5df2.9cb222","order":1,"disp":false,"width":"20","collapse":false},{"id":"eadfc3e6.638e7","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":15,"width":"20","height":"1"},{"id":"65ce3c7.fa22cc4","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":2,"width":"2","height":"5"},{"id":"e7f3d560.96f538","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":4,"width":"2","height":"5"},{"id":"d2719f8e.c65a2","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":6,"width":"8","height":1},{"id":"4f48c9f1.afd618","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":8,"width":"8","height":1},{"id":"e138b7b9.a33558","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":10,"width":"8","height":1},{"id":"ac4df45d.1eb748","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":12,"width":"8","height":1},{"id":"b8eb50ae.b1de1","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":14,"width":"6","height":1},{"id":"cfc3b086.611e","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":17,"width":"20","height":1},{"id":"d78ee0b5.c8bf2","type":"ui_spacer","name":"spacer","group":"79430bf5.e7dee4","order":1,"width":"20","height":1},{"id":"bfa5dac3.b75d38","type":"ui_group","z":"","name":"Uhr","tab":"38fa5df2.9cb222","order":4,"disp":true,"width":"15","collapse":false},{"id":"294dfc0a.791224","type":"ui_group","z":"","name":"Moon","tab":"38fa5df2.9cb222","order":2,"disp":false,"width":"20","collapse":false},{"id":"4dcecac6.b1a494","type":"ui_group","z":"","name":"Default","tab":"","order":1,"disp":false,"width":30,"collapse":false},{"id":"6f308593.0860ac","type":"ui_spacer","name":"spacer","group":"bfa5dac3.b75d38","order":1,"width":"5","height":1},{"id":"8d99a75d.069148","type":"ui_spacer","name":"spacer","group":"bfa5dac3.b75d38","order":2,"width":"6","height":1},{"id":"d13dfece.ca45d","type":"ui_spacer","name":"spacer","group":"bfa5dac3.b75d38","order":3,"width":"6","height":1},{"id":"72164596.d7207c","type":"ui_group","z":"","name":"testy","tab":"","order":1,"disp":true,"width":"6"},{"id":"e3fb87ba.4b5188","type":"ui_spacer","name":"spacer","group":"bfa5dac3.b75d38","order":5,"width":"11","height":1},{"id":"43ab8e3f.7039","type":"position-config","z":"","name":"Current Day","isValide":"true","longitude":"0","latitude":"0","angleType":"deg","timeZoneOffset":"99","timeZoneDST":"0","stateTimeFormat":"3","stateDateFormat":"12"},{"id":"470812d.f0e05ec","type":"ui_spacer","name":"spacer","group":"294dfc0a.791224","order":3,"width":"20","height":1},{"id":"3f23ae37.c58c32","type":"ui_spacer","name":"spacer","group":"294dfc0a.791224","order":1,"width":"20","height":1},{"id":"25f37a14.624686","type":"ui_group","z":"","name":"Empty Space","tab":"38fa5df2.9cb222","order":3,"disp":false,"width":"20","collapse":false},{"id":"27b27a97.a9e1e6","type":"ui_spacer","name":"spacer","group":"25f37a14.624686","order":5,"width":"20","height":"10"},{"id":"67aa9314.dc866c","type":"ui_group","z":"","name":"testy","tab":"","order":1,"disp":true,"width":"6"},{"id":"92725bf1.d58928","type":"ui_spacer","name":"spacer","group":"71d34d3d.d26734","order":6,"width":"4","height":"2"},{"id":"ebffe88d.31cb98","type":"ui_spacer","name":"spacer","group":"","order":1,"width":"4","height":"3"},{"id":"f131577.2d7e2a8","type":"ui_spacer","name":"spacer","group":"bfa5dac3.b75d38","order":4,"width":"6","height":1},{"id":"c40e0413.0dccb8","type":"ui_text","z":"63b8a57d.e20efc","group":"79430bf5.e7dee4","order":13,"width":5,"height":1,"name":"WeatherDescription","label":"","format":"{{msg.payload.current.weather[0].description}}","layout":"row-left","x":1450,"y":120,"wires":[]},{"id":"5bc5561f.638cf8","type":"ui_text","z":"63b8a57d.e20efc","group":"79430bf5.e7dee4","order":7,"width":"3","height":1,"name":"Wind","label":"","format":"{{msg.payload.current.wind_speed}}&nbsp;&nbsp;<i class=\"wi wi-darksky-wind\"></i>&nbsp;&nbsp;{{msg.payload.current.wind_cardinal}}","layout":"col-center","x":1410,"y":200,"wires":[]},{"id":"c4a74cb7.13fb4","type":"ui_text","z":"63b8a57d.e20efc","group":"79430bf5.e7dee4","order":9,"width":"3","height":1,"name":"SunriseTime","label":"","format":"<i class=\"wi wi-owm-01d\"></i>&nbsp;<i class=\"fa fa-arrow-up\"></i>&nbsp;&nbsp;{{msg.payload.current.sunrise}}","layout":"row-center","x":1430,"y":240,"wires":[]},{"id":"fe888ec3.d72f4","type":"ui_text","z":"63b8a57d.e20efc","group":"79430bf5.e7dee4","order":11,"width":"3","height":1,"name":"SunsetTime","label":"","format":"<i class=\"wi wi-wu-sunny\"></i>&nbsp;<i class=\"fa fa-arrow-down\"></i>&nbsp;&nbsp;{{msg.payload.current.sunset}}","layout":"row-center","x":1430,"y":280,"wires":[]},{"id":"6f62c021.8061b","type":"ui_template","z":"63b8a57d.e20efc","group":"79430bf5.e7dee4","name":"WeatherDayForecast","order":18,"width":"20","height":"3","format":"<div style=\"height: 100%; justify-content: center; align-items: center;\">\n <div layout=\"rowicons\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowicons\" style=\"font-size:250%;padding-top: 5px;padding-bottom: 5px\">\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell01}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell02}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell03}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell04}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell05}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell06}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell07}}\"></i></span>\n </div>\n <div layout=\"rowtext\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowtext\" style=\"line-height: 250%\">\n  <span flex style=\"color: white;text-align: center;\">{{data.cell01}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell02}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell03}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell04}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell05}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell06}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell07}}</span>\n </div>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":1460,"y":520,"wires":[[]]},{"id":"f468fc38.d2c4d","type":"ui_text","z":"63b8a57d.e20efc","group":"79430bf5.e7dee4","order":5,"width":"3","height":1,"name":"Temperature","label":"","format":"<p style=\"font-size: 200%\">{{msg.payload.current.temp}}</p>","layout":"row-left","x":1430,"y":160,"wires":[]},{"id":"d3d97d41.dcf2a","type":"http request","z":"63b8a57d.e20efc","name":"Get online weather data","method":"GET","ret":"obj","paytoqs":true,"url":"https://api.openweathermap.org/data/2.5/onecall","tls":"","persist":false,"proxy":"","authType":"","x":790,"y":220,"wires":[["3c7ea308.8bd35c","7ce9c865.c7f118","4a9d09a2.b17148","5f05cdc7.bc8474"]]},{"id":"6c43a898.783058","type":"inject","z":"63b8a57d.e20efc","name":"Trigger Slow","topic":"","payload":"true","payloadType":"bool","repeat":"1200","crontab":"","once":false,"onceDelay":0.1,"x":300,"y":220,"wires":[["166b848d.96e28b"]]},{"id":"3c7ea308.8bd35c","type":"function","z":"63b8a57d.e20efc","name":"Current weather data","func":"var icon = {};\n\n//// Timehandling\nfunction timeConvert(UNIX_timestamp)\n{\n  var a = new Date(UNIX_timestamp * 1000);\n  var hour = a.getHours();\n  var suffix = \" am\";\n  if (hour >= 12) {\n    hour = hour - 12;\n    suffix = \" pm\";\n  }\n  if (hour === 0) {\n    hour = 12;\n  }\n  var min = a.getMinutes();\n  if (min < 10) {min = \"0\" + min;}\n  return hour + ':' + min + suffix;\n}\n\n//// Wind direction\nvar degreesToCardinal = function(deg){\nif (deg>11.25 && deg<=33.75){\nreturn \"NNE\";\n  }else if (deg>33.75 && deg<56.25){\nreturn \"NE\";\n  }else if (deg>56.25 && deg<78.75){\nreturn \"ENE\";\n  }else if (deg>78.75 && deg<101.25){\nreturn \"E\";\n  }else if (deg>101.25 && deg<123.75){\nreturn \"ESE\";\n  }else if (deg>123.75 && deg<146.25){\nreturn \"SE\";\n  }else if (deg>146.25 && deg<168.75){\nreturn \"SSE\";\n  }else if (deg>168.75 && deg<191.25){\nreturn \"S\";\n  }else if (deg>191.25 && deg<213.75){\nreturn \"SSW\";\n  }else if (deg>213.75 && deg<236.25){\nreturn \"SW\";\n  }else if (deg>236.25 && deg<258.75){\nreturn \"WSW\";\n  }else if (deg>258.75 && deg<281.25){\nreturn \"W\";\n  }else if (deg>281.25 && deg<303.75){\nreturn \"WNW\";\n  }else if (deg>303.75 && deg<326.25){\nreturn \"NW\";\n  }else if (deg>326.25 && deg<348.75){\nreturn \"NNW\";\n  }else{\nreturn \"N\"; \n  }\n}\n\n//// Set data for widget\nmsg.payload.current.temp = msg.payload.current.temp.toFixed(1) + ' Â°C';\nmsg.payload.current.wind_speed = msg.payload.current.wind_speed.toFixed(1) + ' m/s';\nmsg.payload.current.wind_cardinal = degreesToCardinal(msg.payload.current.wind_deg);\nmsg.payload.current.sunrise = timeConvert(msg.payload.current.sunrise);\nmsg.payload.current.sunset = timeConvert(msg.payload.current.sunset);\n\n//// Current weather icon\nvar iconString = 'wi-owm-' + msg.payload.current.weather[0].icon + ' wi-10x';\nicon = {\n    ui_control: {\n        icon: iconString\n    }\n}; \n\n//// Output\nreturn [msg, icon];","outputs":2,"noerr":0,"x":1140,"y":220,"wires":[["f468fc38.d2c4d","5bc5561f.638cf8","c40e0413.0dccb8","c4a74cb7.13fb4","fe888ec3.d72f4"],["9094d15e.0bfb3"]]},{"id":"166b848d.96e28b","type":"change","z":"63b8a57d.e20efc","name":"Set location, appid, units","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"set","p":"payload.lat","pt":"msg","to":"47.347431","tot":"str"},{"t":"set","p":"payload.lon","pt":"msg","to":"8.70088","tot":"str"},{"t":"set","p":"payload.appid","pt":"msg","to":"your appid","tot":"str"},{"t":"set","p":"payload.units","pt":"msg","to":"metric","tot":"str"},{"t":"set","p":"units","pt":"flow","to":"payload.units","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":530,"y":220,"wires":[["d3d97d41.dcf2a"]]},{"id":"9094d15e.0bfb3","type":"ui_button","z":"63b8a57d.e20efc","name":"CurrentIcon","group":"79430bf5.e7dee4","order":3,"width":"5","height":"5","passthru":false,"label":"","tooltip":"","color":"","bgcolor":"","icon":"fa-refresh fa-4x","payload":"true","payloadType":"bool","topic":"","x":1430,"y":320,"wires":[[]]},{"id":"37c1c9da.68dc96","type":"ui_template","z":"63b8a57d.e20efc","group":"79430bf5.e7dee4","name":"CurrentWeatherTimeline","order":16,"width":"20","height":"3","format":"<div style=\"height: 100%; justify-content: center; align-items: center;\">\n <div layout=\"rowicons\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowicons\" style=\"font-size:250%;padding-top: 5px;padding-bottom: 5px\">\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell01}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell02}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell03}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell04}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell05}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell06}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell07}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell08}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell09}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell10}}\"></i></span>\n </div>\n <div layout=\"rowtext\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowtext\" style=\"line-height: 250%\">\n  <span flex style=\"color: white;text-align: center;\">{{data.cell01}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell02}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell03}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell04}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell05}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell06}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell07}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell08}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell09}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell10}}</span>\n </div>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":1470,"y":420,"wires":[[]]},{"id":"7ce9c865.c7f118","type":"function","z":"63b8a57d.e20efc","name":"Current weather timeline","func":"var fcdata = {};\n\n//// Set max/min temprature -> Forecast\nfunction formatTemp(high, low)\n{\n    temp = parseFloat(high).toFixed() + 'Â°C'\n    return temp;\n}\n\n//// Set time of expected weather\nfunction timeConvert(UNIX_timestamp)\n{\n  var a = new Date(UNIX_timestamp * 1000);\n  var hour = a.getHours();\n  var suffix = \" am\";\n  if (hour >= 12) {\n    hour = hour - 12;\n    suffix = \" pm\";\n  }\n  if (hour === 0) {\n    hour = 12;\n  }\n  var min = a.getMinutes();\n  if (min < 10) {min = \"0\" + min;}\n//  return hour + ':' + min + suffix;\n  return hour + suffix;\n}\n\n//// Generate datastructure (CSS (Icon)/Time/Temperature)\nfcdata.payload = {\n  rowtext: {\n  \tdata01: {\n      cell01: timeConvert(msg.payload.hourly[1].dt),\n      cell02: timeConvert(msg.payload.hourly[2].dt),\n      cell03: timeConvert(msg.payload.hourly[3].dt),\n      cell04: timeConvert(msg.payload.hourly[4].dt),\n      cell05: timeConvert(msg.payload.hourly[5].dt),\n      cell06: timeConvert(msg.payload.hourly[6].dt),\n      cell07: timeConvert(msg.payload.hourly[7].dt),\n      cell08: timeConvert(msg.payload.hourly[8].dt),\n      cell09: timeConvert(msg.payload.hourly[9].dt),\n      cell10: timeConvert(msg.payload.hourly[10].dt),\n  \t},\n  \tdata02: {\n       cell01: formatTemp(msg.payload.hourly[1].temp),\n       cell02: formatTemp(msg.payload.hourly[2].temp),\n       cell03: formatTemp(msg.payload.hourly[3].temp),\n       cell04: formatTemp(msg.payload.hourly[4].temp),\n       cell05: formatTemp(msg.payload.hourly[5].temp),\n       cell06: formatTemp(msg.payload.hourly[6].temp),\n       cell07: formatTemp(msg.payload.hourly[7].temp),\n       cell08: formatTemp(msg.payload.hourly[8].temp),\n       cell09: formatTemp(msg.payload.hourly[9].temp),\n       cell10: formatTemp(msg.payload.hourly[10].temp),\n  \t}\n  },\n  rowicons: {\n  \tdata01: {\n  \t\tcell01: msg.payload.hourly[1].weather[0].icon,\n  \t\tcell02: msg.payload.hourly[2].weather[0].icon,\n  \t\tcell03: msg.payload.hourly[3].weather[0].icon,\n  \t\tcell04: msg.payload.hourly[4].weather[0].icon,\n  \t\tcell05: msg.payload.hourly[5].weather[0].icon,\n  \t\tcell06: msg.payload.hourly[6].weather[0].icon,\n  \t\tcell07: msg.payload.hourly[7].weather[0].icon,\n  \t\tcell08: msg.payload.hourly[8].weather[0].icon,\n  \t\tcell09: msg.payload.hourly[9].weather[0].icon,\n  \t\tcell10: msg.payload.hourly[10].weather[0].icon,\n  \t}\n  }\n}\n\nreturn fcdata;","outputs":1,"noerr":0,"x":1150,"y":420,"wires":[["37c1c9da.68dc96"]]},{"id":"4a9d09a2.b17148","type":"function","z":"63b8a57d.e20efc","name":"Weather forecast timeline","func":"var fcdata = {};\n\n//// Set max/min temprature\nfunction formatTemp(high, low)\n{\n    temp = parseFloat(high).toFixed() + '/' + parseFloat(low).toFixed() + 'Â°C'\n    return temp;\n}\n\n//// Set name of day\nfunction dayName(unixTime)\n{\n    var d = new Date(unixTime * 1000);\n    var weekday = new Array(7);\n        weekday[0] = \"Sun\";\n        weekday[1] = \"Mon\";\n        weekday[2] = \"Tue\";\n        weekday[3] = \"Wed\";\n        weekday[4] = \"Thu\";\n        weekday[5] = \"Fri\";\n        weekday[6] = \"Sat\";\n\n    return weekday[d.getDay()]\n}\n\n//// Generate datastructure (CSS (Icon)/Time/Temperature)\nfcdata.payload = {\n  rowtext: {\n  \tdata01: {\n      cell01: dayName(msg.payload.daily[1].dt),\n      cell02: dayName(msg.payload.daily[2].dt),\n      cell03: dayName(msg.payload.daily[3].dt),\n      cell04: dayName(msg.payload.daily[4].dt),\n      cell05: dayName(msg.payload.daily[5].dt),\n      cell06: dayName(msg.payload.daily[6].dt),\n      cell07: dayName(msg.payload.daily[7].dt),\n  \t},\n  \tdata02: {\n       cell01: formatTemp(msg.payload.daily[1].temp.max, msg.payload.daily[0].temp.min),\n       cell02: formatTemp(msg.payload.daily[2].temp.max, msg.payload.daily[0].temp.min),\n       cell03: formatTemp(msg.payload.daily[3].temp.max, msg.payload.daily[0].temp.min),\n       cell04: formatTemp(msg.payload.daily[4].temp.max, msg.payload.daily[0].temp.min),\n       cell05: formatTemp(msg.payload.daily[5].temp.max, msg.payload.daily[0].temp.min),\n       cell06: formatTemp(msg.payload.daily[6].temp.max, msg.payload.daily[0].temp.min),\n       cell07: formatTemp(msg.payload.daily[7].temp.max, msg.payload.daily[0].temp.min),\n  \t}\n  },\n  rowicons: {\n  \tdata01: {\n  \t\tcell01: msg.payload.daily[1].weather[0].icon,\n  \t\tcell02: msg.payload.daily[2].weather[0].icon,\n  \t\tcell03: msg.payload.daily[3].weather[0].icon,\n  \t\tcell04: msg.payload.daily[4].weather[0].icon,\n  \t\tcell05: msg.payload.daily[5].weather[0].icon,\n  \t\tcell06: msg.payload.daily[6].weather[0].icon,\n  \t\tcell07: msg.payload.daily[7].weather[0].icon,\n  \t}\n  }\n}\n\nreturn fcdata;","outputs":1,"noerr":0,"x":1150,"y":520,"wires":[["6f62c021.8061b"]]},{"id":"ce7104d1.e75158","type":"moon-position","z":"3f33cde5.12a962","name":"","positionConfig":"43ab8e3f.7039","rules":[],"topic":"","outputs":1,"x":800,"y":180,"wires":[["f5349e39.e3a1a"]]},{"id":"a4baa0b7.e6de5","type":"inject","z":"3f33cde5.12a962","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"60","crontab":"","once":true,"onceDelay":0.1,"x":570,"y":180,"wires":[["ce7104d1.e75158"]]},{"id":"85dd876.9e2a578","type":"ui_template","z":"3f33cde5.12a962","group":"294dfc0a.791224","name":"MoonTimeline","order":2,"width":"20","height":"3","format":"<div style=\"height: 100%; justify-content: center; align-items: center;\">\n<div layout=\"rowicons\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowicons\" style=\"font-size:250%;padding-top: 5px;padding-bottom: 5px\">\n  <font size=\"24px\">{{data.icon01}}</font>\n  <font size=\"24px\">{{data.icon02}}</font>\n  <font size=\"24px\">{{data.icon03}}</font>\n  <font size=\"24px\">{{data.icon04}}</font>\n  <font size=\"24px\">{{data.icon05}}</font>\n  <font size=\"24px\">{{data.icon06}}</font>\n  <font size=\"24px\">{{data.icon07}}</font>\n  <font size=\"24px\">{{data.icon08}}</font>\n </div>\n \n <div layout=\"rowtext\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowtext\" style=\"line-height: 250%\">\n  <span flex style=\"color: white;text-align: center;\">{{data.cell01}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell02}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell03}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell04}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell05}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell06}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell07}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell08}}</span>\n </div>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":1280,"y":180,"wires":[[]]},{"id":"f5349e39.e3a1a","type":"function","z":"3f33cde5.12a962","name":"Moon timeline","func":"//// Define icon\nvar arrayIconConst = [8];\narrayIconConst[1] = 'ðŸŒš';\narrayIconConst[2] = 'ðŸŒ’';\narrayIconConst[3] = 'ðŸŒ“';\narrayIconConst[4] = 'ðŸŒ”';\narrayIconConst[5] = 'ðŸŒ';\narrayIconConst[6] = 'ðŸŒ–';\narrayIconConst[7] = 'ðŸŒ—';\narrayIconConst[8] = 'ðŸŒ˜';\n\n\n//// Generate dataMatrix \nvar arrayIcon = [8];\n\n// Icon\narrayIcon[1] = msg.payload.illumination.phase.pos + 1; // Load icon -> watch position-config.js of node-red-contrib-sun-position\n\nfor (var i=2; i < 9; i++)\n{\n    arrayIcon[i] = arrayIcon[i-1] + 1; // Load icon -> watch position-config.js of node-red-contrib-sun-position\n    \n    // Check if max number was overcome\n    if (arrayIcon[i] > 8)\n    {\n        arrayIcon[i] = 1;\n    }\n}\n\n// Set date\nvar arrayDate = [8];\n\narrayDate[1] = 'Today';\narrayDate[2] = '+3 Days';\narrayDate[3] = '+7 Days';\narrayDate[4] = '+10 Days';\narrayDate[5] = '+15 Days';\narrayDate[6] = '+18 Days';\narrayDate[7] = '+22 Days';\narrayDate[8] = '+25 Days';\n\n\n//// Generate datastructure for output\nvar fcdata = {};\n\nfcdata.payload = {\n    rowtext: {\n  \tdata: {\n      cell01: arrayDate[1],\n      cell02: arrayDate[2],\n      cell03: arrayDate[3],\n      cell04: arrayDate[4],\n      cell05: arrayDate[5],\n      cell06: arrayDate[6],\n      cell07: arrayDate[7],\n      cell08: arrayDate[8],\n  \t}\n  },\n  rowicons: {\n  \tdata: {\n  \t\ticon01: arrayIconConst[arrayIcon[1]],\n  \t\ticon02: arrayIconConst[arrayIcon[2]],\n  \t\ticon03: arrayIconConst[arrayIcon[3]],\n  \t\ticon04: arrayIconConst[arrayIcon[4]],\n  \t\ticon05: arrayIconConst[arrayIcon[5]],\n  \t\ticon06: arrayIconConst[arrayIcon[6]],\n  \t\ticon07: arrayIconConst[arrayIcon[7]],\n  \t\ticon08: arrayIconConst[arrayIcon[8]],\n  \t}\n  }\n}\n\nreturn fcdata;","outputs":1,"noerr":0,"x":1040,"y":180,"wires":[["85dd876.9e2a578"]]},{"id":"aaf818ef.7800a8","type":"ui_template","z":"9c37bb05.ca8348","group":"bfa5dac3.b75d38","name":"Clock","order":6,"width":"6","height":"2","format":"<script>\n    var daylist = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n    (function(scope){ \n            scope.$watch('msg', function(msg) {\n               if (typeof(msg.payload) != \"undefined\") $(\"#DSEGTemp\").text(msg.payload);\n               if (typeof(msg.colour) != \"undefined\") \n                            { \n                             if (msg.colour==\"orange\"){ $(\".Clock-Wrapper\").css('background-color', '#fb7c00');  $(\".lcdClock\").css('color', '#222'); } \n                             if (msg.colour==\"green\") { $(\".Clock-Wrapper\").css('background-color', '#66ac66');  $(\".lcdClock\").css('color', '#222'); }                            \n                             if (msg.colour==\"blue\")  { $(\".Clock-Wrapper\").css('background-color', '#8888ff');  $(\".lcdClock\").css('color', '#222'); }\n                             if (msg.colour==\"yellow\"){ $(\".Clock-Wrapper\").css('background-color', '#bbbb44');  $(\".lcdClock\").css('color', '#222'); } \n                             if (msg.colour==\"white\") { $(\".Clock-Wrapper\").css('background-color', '#aaaaaa');  $(\".lcdClock\").css('color', '#222'); } \n                             if (msg.colour==\"pink\")  { $(\".Clock-Wrapper\").css('background-color', '#ff8888');  $(\".lcdClock\").css('color', '#222'); } \n                             if (msg.colour==\"red\")  { $(\".Clock-Wrapper\").css('background-color', '#aa2222');  $(\".lcdClock\").css('color', '#ccaa22'); } \n                            }\n            });\n    })(scope);\n\n    function genTimerStrings(tm, num){\n    \n    \tvar i;\n    \tvar ret = tm.toString(10);\n    \tvar left = ret.length;\n    \n    \tif( left < num){\n    \t\tfor(i=0; i<( num - left ); i++ ){\n    \t\t\tret = String(0) + ret;\n    \t\t}\n    \t}\n    \treturn ret;\n    }\n\n    function updateTimer(){\n    \tvar ret;\n    \tvar date = new Date();\n    \tvar tm_year, tm_mon, tm_date, tm_hour, tm_min, tm_sec, tm_msec,tm_day;\n    \tvar colon = ':';\n    \ttm_year = date.getFullYear();\n    \ttm_mon = date.getMonth()+1;\n    \ttm_date = date.getDate();\n    \ttm_day = date.getDay();\n    \ttm_hour = date.getHours();\n    \ttm_min = date.getMinutes();\n    \ttm_sec = date.getSeconds();\n    \ttm_msec = date.getMilliseconds();\n    \n    \ttm_mon = genTimerStrings(tm_mon, 2);\n    \ttm_date = genTimerStrings(tm_date, 2);\n    \ttm_hour = genTimerStrings(tm_hour, 2);\n    \ttm_min = genTimerStrings(tm_min, 2);\n    \ttm_sec = genTimerStrings(tm_sec, 2);\n    \ttm_day = daylist[tm_day];\n    \n    \tdocument.getElementById(\"DSEGClock\").innerHTML = tm_hour + colon + tm_min + \"<span style=\\\"font-size:30px;\\\">\"  + tm_sec + \"</span>\";\n    \tdocument.getElementById(\"DSEGClock-Year\").innerHTML = \"<span class=\\\"D7MI\\\">\" + tm_date + \"-\" + tm_mon + \"-\" + tm_year + ' ' + \"</span><span class=\\\"D14MI\\\">\" + tm_day  + \"</span>\";\n    \n    \tsetTimeout(\"updateTimer()\", 500 - date.getMilliseconds()%500 );\n    }\n\n    updateTimer();\n</script>\n\n<style type=\"text/css\">\n.lcdClock {\n\tbackground-color:#000000;\n\tfont-size:100%;\n\tpadding-left:10px;\n\tpadding-right:10px;\n\tpadding-bottom:10px;\n\tmax-width:300px;\n\tline-height:160%;\n\tcolor:#222;\n\tfont-family:Meiryo, 'Lucida Grande','Hiragino Kaku Gothic ProN', sans-serif;\n}\n\n@font-face {\n  font-family: \"D7MI\";\n  src: url(\"/myfonts/DSEG7Modern-Italic.woff\") format('woff');\n}\n\n@font-face {\n  font-family: \"D14MI\";\n  src: url(\"/myfonts/DSEG14Modern-Italic.woff\") format('woff');\n}\n\n@font-face {\n  font-family: \"D7MBI\";\n  src: url(\"/myfonts/DSEG7Modern-BoldItalic.woff\") format('woff');\n}\n\n@font-face {\n  font-family: \"DWEATHER\";\n  src: url(\"/myfonts/DSEGWeather.woff\") format('woff');\n}\n\n.D7MI {\nfont-family: \"D7MI\";\n}\n\n.D7MBI {\nfont-family: \"D7MBI\";\n}\n\n.D14MI {\nfont-family: \"D14MI\";\n}\n\n.DWEATHER {\nfont-family: \"DWEATHER\";\nfont-size:72px;\nheight:72px;\n}\n\n.Clock-Wrapper{\n\tposition:relative;\n\tborder:6px solid #000;\n\tborder-radius:9px;\n\theight:68px;\n\twidth:160px;\n\tbackground-color:#D3D3D3;\n\n\tbox-shadow: 4px 4px 28px 0px rgba(0,0,0,0.3) inset; \n}\n\n.Clock-Time-Background{\n\tz-index:50;\n\tcolor:rgba(0,0,0,0.15);\n}\n\n.Clock-Time-Front{\n\tz-index:100;\n}\n\n.Clock-Time-Background,.Clock-Time-Front {\n   \tposition:absolute;\n\ttop:38px;\n\tleft:5px; \n\tfont-size:60px;\n}\n\n.Clock-Year-Background{\n\tz-index:50;\n;\n\tcolor:rgba(0,0,0,0.1);\n\tfont-size:18px;\n}\n\n.Clock-Year-Front{\n\tz-index:100;\n}\n\n.Clock-Year-Background,.Clock-Year-Front {\n   \tposition:absolute;\n\ttop:2px;\n\tleft:5px; \n\tfont-size:18px;\n}\n\n.temp { z-index:100; }\n.tempBack { z-index:50; color:rgba(0,0,0,0.1); }\n.temp,.tempBack {\n   \tposition:absolute;\n\ttop:28px;\n\tleft:210px; \n\tfont-size:42px;\n}\n\n.tempc { z-index:100; }\n.tempcBack { z-index:50; color:rgba(0,0,0,0.1); }\n.tempc,.tempcBack {\n   \tposition:absolute;\n\ttop:36px;\n\tleft:278px; \n\tfont-size:24px;\n}\n\n#DSEG7_OUTPUT{\n\tfont-family: \"D7MI\";\n}\n\n#DSEG14_OUTPUT{\n\tfont-family: \"D14MI\";\n}\n\n#DSEG14_OUTPUT, #DSEG7_OUTPUT{\n\tfont-size:18px;\n\tmargin-top:2px;\n\tmargin-bottom:10px;\n}\n\n</style>\n\n\n<div class=\"Clock-Wrapper center lcdClock\">\n\t<span id=\"DSEGClock\" class=\"Clock-Time-Front D7MBI\"></span>\n\t<span id=\"DSEGClock-Year\" class=\"Clock-Year-Front\"></span>\n</div>\n\n","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":190,"y":180,"wires":[[]]},{"id":"5f05cdc7.bc8474","type":"debug","z":"63b8a57d.e20efc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1110,"y":640,"wires":[]}]